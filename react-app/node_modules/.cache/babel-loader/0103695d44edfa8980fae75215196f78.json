{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { hashObject } from \"../../utils/hashObject\";\n/** @hidden */\n\nexport class OrderedDistinctEndpointComponent {\n  constructor(executionContext) {\n    this.executionContext = executionContext;\n  }\n\n  nextItem() {\n    return __awaiter(this, void 0, void 0, function* () {\n      const {\n        headers,\n        result\n      } = yield this.executionContext.nextItem();\n\n      if (result) {\n        const hashedResult = yield hashObject(result);\n\n        if (hashedResult === this.hashedLastResult) {\n          return {\n            result: undefined,\n            headers\n          };\n        }\n\n        this.hashedLastResult = hashedResult;\n      }\n\n      return {\n        result,\n        headers\n      };\n    });\n  }\n\n  hasMoreResults() {\n    return this.executionContext.hasMoreResults();\n  }\n\n}","map":{"version":3,"sources":["../../../src/queryExecutionContext/EndpointComponent/OrderedDistinctEndpointComponent.ts"],"names":[],"mappings":";AAIA,SAAS,UAAT,QAA2B,wBAA3B;AAEA;;AACA,OAAM,MAAO,gCAAP,CAAuC;AAE3C,EAAA,WAAA,CAAoB,gBAApB,EAAsD;AAAlC,SAAA,gBAAA,GAAA,gBAAA;AAAsC;;AAE7C,EAAA,QAAQ,GAAA;;AACnB,YAAM;AAAE,QAAA,OAAF;AAAW,QAAA;AAAX,UAAsB,MAAM,KAAK,gBAAL,CAAsB,QAAtB,EAAlC;;AACA,UAAI,MAAJ,EAAY;AACV,cAAM,YAAY,GAAG,MAAM,UAAU,CAAC,MAAD,CAArC;;AACA,YAAI,YAAY,KAAK,KAAK,gBAA1B,EAA4C;AAC1C,iBAAO;AAAE,YAAA,MAAM,EAAE,SAAV;AAAqB,YAAA;AAArB,WAAP;AACD;;AACD,aAAK,gBAAL,GAAwB,YAAxB;AACD;;AACD,aAAO;AAAE,QAAA,MAAF;AAAU,QAAA;AAAV,OAAP;AACD,K;AAAA;;AAEM,EAAA,cAAc,GAAA;AACnB,WAAO,KAAK,gBAAL,CAAsB,cAAtB,EAAP;AACD;;AAlB0C","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport { Response } from \"../../request\";\nimport { ExecutionContext } from \"../ExecutionContext\";\nimport { hashObject } from \"../../utils/hashObject\";\n\n/** @hidden */\nexport class OrderedDistinctEndpointComponent implements ExecutionContext {\n  private hashedLastResult: string;\n  constructor(private executionContext: ExecutionContext) {}\n\n  public async nextItem(): Promise<Response<any>> {\n    const { headers, result } = await this.executionContext.nextItem();\n    if (result) {\n      const hashedResult = await hashObject(result);\n      if (hashedResult === this.hashedLastResult) {\n        return { result: undefined, headers };\n      }\n      this.hashedLastResult = hashedResult;\n    }\n    return { result, headers };\n  }\n\n  public hasMoreResults() {\n    return this.executionContext.hasMoreResults();\n  }\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}